{% load menu_tags %}
<div class="dsfacile-collapse dsfacile-mega-menu"
     id="mega-menu-{{ menu.parent_menu_item.id }}"
     tabindex="-1">
    <div class="dsfacile-container dsfacile-container--fluid dsfacile-container-lg">
        <button class="dsfacile-link--close dsfacile-link"
                aria-controls="mega-menu-{{ menu.parent_menu_item.id }}">Fermer</button>
        <div class="dsfacile-grid-row dsfacile-grid-row-lg--gutters">
            <div class="dsfacile-col-12 dsfacile-col-lg-8 dsfacile-col-offset-lg-4--right">
                <div class="dsfacile-mega-menu__leader">
                    <h4 class="dsfacile-h4 dsfacile-mb-2v">{{ menu.title }}</h4>
                    {% if menu.description %}<p class="dsfacile-hidden dsfacile-displayed-lg">{{ menu.description|safe }}</p>{% endif %}
                    {% if menu.main_link %}
                        <a class="dsfacile-link dsfacile-fi-arrow-right-line dsfacile-link--icon-right dsfacile-link--align-on-content"
                           href="{{ menu.main_link }}">Voir toute la rubrique</a>
                    {% endif %}
                </div>
            </div>
            {% for category in menu.get_categories %}
                <div class="dsfacile-col-12 dsfacile-col-lg-3">
                    <h5 class="dsfacile-mega-menu__category">
                        <a class="dsfacile-nav__link" href="#" target="_self">
                            {% if category.category.heading %}
                                {{ category.category.heading }}
                            {% else %}
                                {{ category.category.title }}
                            {% endif %}
                        </a>
                    </h5>
                    {% flat_menu category.category.handle template="content_manager/menus/mega_menu_category.html" %}
                </div>
            {% endfor %}
        </div>
    </div>
</div>
